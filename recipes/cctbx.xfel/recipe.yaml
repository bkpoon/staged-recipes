context:
  name: cctbx.xfel
  version: "2025.8a29"
  # version: "2025.7"

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  url: https://artprodcus3.artifacts.visualstudio.com/Ae7d56bcd-6398-4fef-808d-577536b26a95/67feccdf-8c7f-4afe-8ff5-f21e77cdbf9d/_apis/artifact/cGlwZWxpbmVhcnRpZmFjdDovL2NjdGJ4LXJlbGVhc2UvcHJvamVjdElkLzY3ZmVjY2RmLThjN2YtNGFmZS04ZmY1LWYyMWU3N2NkYmY5ZC9idWlsZElkLzE3Mzg3L2FydGlmYWN0TmFtZS9jY3RieC0yMDI1LjhhMjk1/content?format=file&subPath=/cctbx-{{ version }}.tar.gz
  # url: https://github.com/cctbx/cctbx_project/releases/download/v${{ version }}/cctbx-${{ version }}.tar.gz
  # sha256: 05dc073224ca3ef4e41acf575a2c1a6fd7b157a6c56540bcdf5aec5aa7ccf0e2
  patches:
    - dxtbx.patch

build:
  skip:
    - match(python, "<3.10")
    - match(python, ">3.12")
  number: 0

requirements:
  build:
    - ${{ compiler('c') }}
    - ${{ compiler('cxx') }}
    - ${{ stdlib('c') }}
  host:
    - eigen
    - libboost-python-devel
    - libboost-devel
    - python
    - dials
    - pip
    - scons
    - setuptools

    - git
    - git-lfs

  run:
    - dials
    - iota
    - mysql
    - mysqlclient
    - pydrive2
    - python

tests:
  - python:
      imports:
      - xfel
      pip_check: true

about:
  homepage: https://cci.lbl.gov/xfel/
  summary: 'Open-source tools for serial crystallographic data processing'
  description: |
    cctbx.xfel is a suite of software tools designed to process
    diffraction data from serial femtosecond crystallography (SFX)
    measurements at an X-ray free-electron laser (XFEL) or a
    synchrotron. Built on the Computational Crystallographic Toolbox
    (cctbx), the same toolbox on which Phenix, DIALS, LABELIT, and
    post-refinement and merging program, PRIME are built, it enables
    the user to solve difficult problems relating to processing serial
    crystallographic data. The programs and modules provided by
    cctbx.xfel can reduce a large set of still diffraction images
    recorded at Stanfordâ€™s Linac Coherent Light Source (LCLS), SACLA,
    the European XFEL, or a synchrotron, to a single MTZ file
    containing merged reflection intensities suitable for structure
    solution.
  license: BSD-3-Clause-LBNL
  license_file: LICENSE.txt
  documentation: https://cci.lbl.gov/xfel/
  repository: https://github.com/cctbx/cctbx_project/tree/master/xfel

extra:
  recipe-maintainers:
    - bkpoon
    - dwpaley
    - phyy-nx
